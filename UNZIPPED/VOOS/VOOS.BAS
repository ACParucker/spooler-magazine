'****************** PROGRAMA : VOOS LOUCOS     (QUICKBASIC 4.0) *************
'****************** (C) PAM SOFTWARE            VERAO  1990&93  *************

'****************** DEFINI€AO DE VARIAVEIS E MENU ************************
SCREEN 1
DEF SEG = &HB800
BLOAD "ABERTURA.PIC"
DIM RECOR$(5)
DIM MENU%(8100), CAR1%(120), CAR2%(120), CAR3%(130), CAR4%(120), CAR5%(120)
DIM EXPLODE1%(150), EXPLODE2%(150), CADEIRA%(40), PARAQ%(110), ALDEIA%(560)
GOSUB LEITURA
GOSUB VELOCIDADE
ESQ$ = "k": DIR$ = "l": EJE$ = "a"

VOOSLOUCOS:
CARROS = 3: DINHEIRO = 500000: MORAL = 50: TEMPO = 0: DIA = 1
NOME$ = "": O1$ = "X": O2$ = "": O3$ = "X": O4$ = "": O5$ = "": O6$ = "X": O7$ = "": O8$ = "X"
CICLOESCOLHA:
PUT (0, 0), MENU%, PSET
LOCATE 7, 26: PRINT "(C)PamSoft"
LOCATE 8, 26: PRINT "   1993"
DIM MENU1%(300), MENU2%(350), MENU3%(350)
GET (95, 104)-(276, 116), MENU1%
GET (95, 136)-(276, 150), MENU2%
GET (95, 168)-(276, 182), MENU3%
DIM a%(186), VEC(10), VEF(10)
GET (35, 60)-(70, 100), a%
PUT (35, 60), a%, PSET
a = 60: CO1$ = CHR$(&HAA) + CHR$(&H99)
VEC(1) = 1: VEC(2) = 1: VEC(3) = .8: VEC(4) = .8: VEC(5) = .6: VEC(6) = .6: VEC(7) = .4: VEC(8) = .4: VEC(9) = .4: VEC(10) = .4
VEF(1) = .8: VEF(2) = .8: VEF(3) = .8: VEF(4) = .8: VEF(5) = .8: VEF(6) = 1: VEF(7) = 1: VEF(8) = 1: VEF(9) = 1: VEF(10) = 1

'****************** ESCOLHA DE UMA OP€AO ************************************
OPCAO:
I$ = INKEY$: IF I$ = "" THEN GOTO OPCAO
IF I$ = CHR$(27) THEN CLS : PRINT TIME$: PRINT "VOLTE SEMPRE !": FOR a = 1 TO 1500: NEXT a: END
IF I$ = CHR$(13) THEN GOSUB MODULO
IF I$ = CHR$(0) + CHR$(80) THEN GOSUB MOVERBAIXO
IF I$ = CHR$(0) + CHR$(72) THEN GOSUB MOVERCIMA
GOTO OPCAO

MOVERBAIXO:
IF a = 156 THEN RETURN
B = a + 32
FOR F = a TO B
PUT (35, F), a%, PSET
NEXT F
a = B
RETURN

MOVERCIMA:
IF a = 60 THEN RETURN
B = a - 32
FOR F = a TO B STEP -1
PUT (35, F), a%, PSET
NEXT F
a = B
RETURN

MODULO:
IF a = 60 THEN LOCATE 12, 13: GOTO CONTJOGAR1
IF a = 92 THEN GOSUB REDIFINIR: GOTO CICLOESCOLHA
IF a = 124 THEN GOSUB INSTRUCOES: GOTO CICLOESCOLHA ELSE GOSUB RECORDES: GOTO CICLOESCOLHA

'****************** OP€AO JOGAR *********************************************
CONTJOGAR1:
CLS : RANDOMIZE TIMER
IF DIA = 1 AND TEMPO = 0 THEN HORAS = 7: HORAS2 = 13: COMPMAX = 7
IF DIA = 1 AND TEMPO = 1 THEN HORAS = 14: HORAS2 = 20: COMPMAX = 7
IF DIA = 2 AND TEMPO = 0 THEN HORAS = 8: HORAS2 = 13: COMPMAX = 6
IF DIA = 2 AND TEMPO = 1 THEN HORAS = 14: HORAS2 = 19: COMPMAX = 6
IF DIA = 3 AND TEMPO = 0 THEN HORAS = 9: HORAS2 = 13: COMPMAX = 5
IF DIA = 3 AND TEMPO = 1 THEN HORAS = 14: HORAS2 = 18: COMPMAX = 5
COMP = 1
CONTJOGAR2:
CLS : RANDOMIZE TIMER
LINE (0, 1)-(320, 37), 2, BF
LINE (4, 7)-(315, 31), 0, BF
IF TEMPO = 0 THEN LOCATE 18, 30: PRINT "MANHA" ELSE LOCATE 18, 30: PRINT "TARDE"
LOCATE 19, 30: PRINT "DIA"; DIA
LOCATE 3, 10: PRINT "CONDICOES ATMOSFERICAS"
VENTO = INT(RND * 10) + 1: DIRECAO = INT(RND * 2) + 1
IF VENTO > 5 THEN LOCATE 10, 5: PRINT "Vento forte com intensidade "; VENTO: VENTO$ = STR$(VENTO) ELSE LOCATE 10, 5: PRINT "Vento fraco com intensidade "; VENTO: VENTO$ = STR$(VENTO)
IF DIRECAO = 1 THEN LOCATE 10, 36: PRINT CHR$(27): VENTO$ = VENTO$ + CHR$(27): IMPULSO = VEC(VENTO) ELSE LOCATE 10, 36: PRINT CHR$(26): VENTO$ = VENTO$ + CHR$(26): IMPULSO = VEF(VENTO)
TESTE = INT(RND * 2) + 1
IF TESTE = 1 THEN LOCATE 13, 3: PRINT "O Sol brilha,cont. de tempo estavel" ELSE LOCATE 13, 2: PRINT "Acabou de chover e preve-se mais chuva"
LOCATE 21, 8: PRINT "HORARIO DA SESSAO DE SALTOS": LOCATE 22, 10: PRINT HORAS; ": 00   -  "; HORAS2 - 1; ": 00"
CICLOTEMPO:
T$ = INKEY$: IF T$ = "" THEN GOTO CICLOTEMPO
JOGAR2:
SOBE = 2: EJECTAR = 0: TECEJE = 0: z = 320: ANDA = 3: PT1 = 20: PT2 = 21: PT3 = 21: PT4 = 22: PF1 = 48: PF2 = 49: PF3 = 47: PF4 = 48
CLS
LINE (0, 1)-(320, 37), 2, BF
LINE (4, 7)-(315, 31), 0, BF
LOCATE 3, 18: PRINT "OFICINA"
LOCATE 8, 5: PRINT "MOTOR": LOCATE 8, 15: PRINT " 900 cc          500000$": LOCATE 9, 15: PRINT "1400 cc          900000$"
LOCATE 11, 5: PRINT "PNEUS": LOCATE 11, 15: PRINT "Normal           100000$": LOCATE 12, 15: PRINT "Chuva            160000$"
LOCATE 14, 5: PRINT "TURBO": LOCATE 14, 15: PRINT "Sim              300000$": LOCATE 15, 15: PRINT "Nao"
LOCATE 17, 5: PRINT "SUSPENSAO": LOCATE 17, 15: PRINT "Sim              250000$": LOCATE 18, 15: PRINT "Nao": LOCATE 18, 5: PRINT "EXTRA"
LOCATE 21, 9: PRINT "Dinheiro actual"; STR$(DINHEIRO) + "$"
LOCATE 23, 15: PRINT "[Esc] Saltar"
SETAY = 8: LOCATE SETAY, 23: PRINT CHR$(27)
IF O1$ = "X" THEN LOCATE 8, 27: PRINT "X"
IF O2$ = "X" THEN LOCATE 9, 27: PRINT "X"
IF O3$ = "X" THEN LOCATE 11, 27: PRINT "X"
IF O4$ = "X" THEN LOCATE 12, 27: PRINT "X"
IF O5$ = "X" THEN LOCATE 14, 27: PRINT "X"
IF O6$ = "X" THEN LOCATE 15, 27: PRINT "X"
IF O7$ = "X" THEN LOCATE 17, 27: PRINT "X"
IF O8$ = "X" THEN LOCATE 18, 27: PRINT "X"
CICLOSETA:
T$ = INKEY$
IF T$ = CHR$(0) + CHR$(80) AND SETAY < 18 THEN SETAY = SETAY + 1: LOCATE SETAY, 23: PRINT CHR$(27): LOCATE SETAY - 1, 23: PRINT " "
IF T$ = CHR$(0) + CHR$(72) AND SETAY > 8 THEN SETAY = SETAY - 1: LOCATE SETAY, 23: PRINT CHR$(27): LOCATE SETAY + 1, 23: PRINT " "
IF T$ = CHR$(13) THEN GOSUB ESCOLHA
IF T$ = CHR$(27) THEN GOTO COMECO
IF DINHEIRO <= 0 THEN LOCATE 22, 7: PRINT "NAO PODE EFECTUAR MAIS TROCAS,": LOCATE 23, 7: PRINT " ATE POSSUIR SALDO POSITIVO.": FOR a = 1 TO 3000: NEXT a: GOTO COMECO
GOTO CICLOSETA

ESCOLHA:
IF SETAY = 8 AND O2$ = "X" AND O1$ <> "X" THEN O1$ = "X": O2$ = "": DINHEIRO = DINHEIRO + 900000 - 500000: LOCATE SETAY, 27: PRINT "X": LOCATE SETAY + 1, 27: PRINT " "
IF SETAY = 8 AND O1$ <> "X" THEN O1$ = "X": DINHEIRO = DINHEIRO - 500000: LOCATE SETAY, 27: PRINT "X": LOCATE SETAY + 1, 27: PRINT " "
IF SETAY = 9 AND O1$ = "X" AND O2$ <> "X" THEN O2$ = "X": O1$ = "": DINHEIRO = DINHEIRO - 900000 + 500000: LOCATE SETAY, 27: PRINT "X": LOCATE SETAY - 1, 27: PRINT " "
IF SETAY = 9 AND O2$ <> "X" THEN O2$ = "X": DINHEIRO = DINHEIRO - 900000: LOCATE SETAY, 27: PRINT "X": LOCATE SETAY - 1, 27: PRINT " "
IF SETAY = 11 AND O4$ = "X" AND O3$ <> "X" THEN O3$ = "X": O4$ = "": DINHEIRO = DINHEIRO + 160000 - 100000: LOCATE SETAY, 27: PRINT "X": LOCATE SETAY + 1, 27: PRINT " "
IF SETAY = 11 AND O3$ <> "X" THEN O3$ = "X": DINHEIRO = DINHEIRO - 100000: LOCATE SETAY, 27: PRINT "X": LOCATE SETAY + 1, 27: PRINT " "
IF SETAY = 12 AND O3$ = "X" AND O4$ <> "X" THEN O4$ = "X": O3$ = "": DINHEIRO = DINHEIRO - 160000 + 100000: LOCATE SETAY, 27: PRINT "X": LOCATE SETAY - 1, 27: PRINT " "
IF SETAY = 12 AND O4$ <> "X" THEN O4$ = "X": DINHEIRO = DINHEIRO - 160000: LOCATE SETAY, 27: PRINT "X": LOCATE SETAY - 1, 27: PRINT " "
IF SETAY = 14 AND O6$ = "X" AND O5$ <> "X" THEN O5$ = "X": O6$ = "": DINHEIRO = DINHEIRO - 300000: LOCATE SETAY, 27: PRINT "X": LOCATE SETAY + 1, 27: PRINT " "
IF SETAY = 14 AND O5$ <> "X" THEN O5$ = "X": DINHEIRO = DINHEIRO - 300000: LOCATE SETAY, 27: PRINT "X": LOCATE SETAY + 1, 27: PRINT " "
IF SETAY = 15 AND O5$ = "X" AND O6$ <> "X" THEN O6$ = "X": O5$ = "": DINHEIRO = DINHEIRO + 300000: LOCATE SETAY, 27: PRINT "X": LOCATE SETAY - 1, 27: PRINT " "
IF SETAY = 15 AND O6$ <> "X" THEN O6$ = "X": LOCATE SETAY, 27: PRINT "X": LOCATE SETAY - 1, 27: PRINT " "
IF SETAY = 17 AND O8$ = "X" AND O7$ <> "X" THEN O7$ = "X": O8$ = "": DINHEIRO = DINHEIRO - 250000: LOCATE SETAY, 27: PRINT "X": LOCATE SETAY + 1, 27: PRINT " "
IF SETAY = 17 AND O7$ <> "X" THEN O7$ = "X": DINHEIRO = DINHEIRO - 250000: LOCATE SETAY, 27: PRINT "X": LOCATE SETAY + 1, 27: PRINT " "
IF SETAY = 18 AND O7$ = "X" AND O8$ <> "X" THEN O8$ = "X": O7$ = "": DINHEIRO = DINHEIRO + 250000: LOCATE SETAY, 27: PRINT "X": LOCATE SETAY - 1, 27: PRINT " "
IF SETAY = 18 AND O8$ <> "X" THEN O8$ = "X": LOCATE SETAY, 27: PRINT "X": LOCATE SETAY - 1, 27: PRINT " "
LOCATE 21, 24: PRINT "             "
LOCATE 21, 32 - LEN(STR$(DINHEIRO)): PRINT STR$(DINHEIRO) + "$"
RETURN

'****************** COME€O DO MOVIMENTO DO JOGO *****************************
COMECO:
IF TESTE <> 1 AND O4$ <> "X" THEN IMPULSO = IMPULSO - .2
IF TESTE = 1 AND O4$ = "X" THEN IMPULSO = IMPULSO - .2
IF O1$ = "X" THEN VELOCMAX = 121
IF O2$ = "X" THEN VELOCMAX = 151

'****************** ECRAN 1 *************************************************
CLS
LINE (0, 1)-(320, 37), 2, BF
LINE (4, 7)-(315, 31), 0, BF
LOCATE 4, 10: PRINT "Km/h": LOCATE 2, 4: PRINT "Vento -"; VENTO$
LOCATE 2, 19: PRINT "Dia -"; DIA: LOCATE 4, 17: PRINT "Moral -"; STR$(MORAL) + "%"
LOCATE 4, 30: PRINT "Carros -"; STR$(CARROS)
LOCATE 2, 38 - LEN(STR$(DINHEIRO)): PRINT STR$(DINHEIRO) + "$"
LINE (0, 40)-(320, 151), 1, BF
FOR a = 100 TO 108 STEP 4
PRESET (0, a): DRAW "R320"
NEXT a
FOR a = 4 TO 320 STEP 8
PRESET (a, 100): DRAW "D8"
NEXT a
PSET (0, 152): DRAW "R320": PAINT (0, 185), CO1$: LINE (0, 152)-(320, 152), 1
PUT (3, 137), CAR1%, PSET: PUT (214, 55), ALDEIA%, PSET
I = 214: s = 42: METROS = 2000: VELOC = 0
FOR a = 1 TO 70
LOCATE 3, 14: PRINT HORAS; ": 00 HORAS"
LOCATE 3, 14: PRINT "               "
NEXT a

'****************** MOVIMENTO EM TERRA **************************************
CICLO1:
T$ = INKEY$
IF T$ = CHR$(27) THEN GOTO RECORDES2
IF T$ = ESQ$ AND TECESQ = 0 AND VELOC < VELOCMAX THEN TECESQ = 1: TECDIR = 0: VELOC = VELOC + IMPULSO: s = s + 2 * ABS(IMPULSO)
IF T$ = DIR$ AND TECDIR = 0 AND VELOC < VELOCMAX THEN TECESQ = 0: TECDIR = 1: VELOC = VELOC + IMPULSO: s = s + 2 * ABS(IMPULSO)
IF T$ = "" AND VELOC > 0 THEN VELOC = VELOC - 1: IF s > 42 THEN s = s - 2
IF VELOC > 120 AND O5$ = "X" AND TURBO = 0 THEN VELOC = VELOC + 20: s = s + 40: VELOCMAX = VELOCMAX + 40: TURBO = 1
IF VELOC > 0 THEN PSET (20, 152): PSET (21, 152): PSET (49, 152): PSET (48, 152): PSET (21, 147): PSET (22, 147): PSET (47, 147): PSET (48, 147)
IF VELOC > 0 THEN PSET (7, 151): PSET (7, 148): PSET (8, 149): PSET (6, 150): PSET (7, 150)
METROS = METROS - VELOC / 8 AND METROS > 20: LOCATE 4, 5: PRINT INT(VELOC): IF VELOC < 0 THEN VELOC = 0
IF VELOC > 0 THEN I = I - VELOC / 80: PUT (I, 55), ALDEIA%, PSET
IF VELOC = 0 THEN SOUND 42, .06
IF VELOC > 0 THEN PRESET (20, 152): PRESET (21, 152): PRESET (49, 152): PRESET (48, 152): PRESET (21, 147): PRESET (22, 147): PRESET (47, 147): PRESET (48, 147)
IF VELOC > 0 THEN PRESET (7, 151), 1: PRESET (7, 148), 1: PRESET (8, 149), 1: PRESET (6, 150), 1: PRESET (7, 150), 1
IF VELOC > 0 THEN SOUND s, 1.5
IF METROS < 500 AND VELOC > 0 THEN GOSUB FOSSO
GOTO CICLO1

FOSSO:
z = z - VELOC / 80
IF z <= 280 THEN GOTO SALTO
LINE (z, 152)-(320, 184), 1, BF
RETURN

SALTO:
T$ = INKEY$
IF T$ = CHR$(27) THEN GOTO RECORDES2
IF T$ = ESQ$ AND TECESQ = 0 AND VELOC < VELOCMAX THEN TECESQ = 1: TECDIR = 0: VELOC = VELOC + IMPULSO / 2: s = s + 2 * ABS(IMPULSO)
IF T$ = DIR$ AND TECDIR = 0 AND VELOC < VELOCMAX THEN TECESQ = 0: TECDIR = 1: VELOC = VELOC + IMPULSO / 2: s = s + 2 * ABS(IMPULSO)
IF T$ = "" AND VELOC > 0 THEN VELOC = VELOC - 1: IF s > 42 THEN s = s - 2
IF VELOC > 120 AND O5$ = "X" AND TURBO = 0 THEN VELOC = VELOC + 20: s = s + 40: VELOCMAX = VELOCMAX + 40: TURBO = 1
IF VELOC > 0 THEN PSET (PT1, 152): PSET (PT2, 152): PSET (PF2, 152): PSET (PF1, 152): PSET (PT3, 147): PSET (PT4, 147): PSET (PF3, 147): PSET (PF4, 147)
LOCATE 4, 5: PRINT INT(VELOC): IF VELOC < 0 THEN VELOC = 0
IF VELOC > 0 THEN ANDA = ANDA + VELOC / 30: PUT (ANDA, 137), CAR1%, PSET
IF VELOC = 0 THEN SOUND 42, .06
PT1 = PT1 + VELOC / 30: PT2 = PT2 + VELOC / 30: PT3 = PT3 + VELOC / 30: PT4 = PT4 + VELOC / 30
PF1 = PF1 + VELOC / 30: PF2 = PF2 + VELOC / 30: PF3 = PF3 + VELOC / 30: PF4 = PF4 + VELOC / 30
IF VELOC > 0 THEN PRESET (PT1, 152): PRESET (PT2, 152): PRESET (PF2, 152): PRESET (PF1, 152): PRESET (PT3, 147): PRESET (PT4, 147): PRESET (PF3, 147): PRESET (PF4, 147)
IF VELOC > 0 THEN SOUND s, 1.5
IF ANDA >= 255 THEN GOTO SALTO2
GOTO SALTO

'***************** ECRAN 2 **************************************************
SALTO2:
CLS
LINE (0, 1)-(320, 37), 2, BF
LINE (4, 7)-(315, 31), 0, BF
LOCATE 4, 10: PRINT "Km/h": LOCATE 2, 4: PRINT "Vento -"; VENTO$
LOCATE 2, 19: PRINT "Dia -"; DIA: LOCATE 4, 17: PRINT "Moral -"; STR$(MORAL) + "%"
LOCATE 4, 30: PRINT "Carros -"; STR$(CARROS)
LOCATE 2, 38 - LEN(STR$(DINHEIRO)): PRINT STR$(DINHEIRO) + "$"
LINE (0, 40)-(320, 151), 1, BF
LINE (40, 152)-(320, 184), 1, BF
FOR a = 100 TO 108 STEP 4
PRESET (0, a): DRAW "R80"
NEXT a
FOR a = 4 TO 80 STEP 8
PRESET (a, 100): DRAW "D8"
NEXT a
PSET (0, 152): DRAW "R40D32R280": PAINT (0, 154), CO1$: LINE (0, 152)-(40, 152), 1: LINE (40, 152)-(40, 184), 1: LINE (40, 184)-(320, 184), 1
CX = 80
IF DIA = 1 THEN GOSUB CARRO5 ELSE IF DIA = 2 THEN GOSUB CARRO4 ELSE IF DIA = 3 THEN GOSUB CARRO3
CARX = 35: CARY = 137: VELOC2 = VELOC

'***************** MOVIMENTO NO AR ******************************************
CICLOSALTO:
IF VELOC2 > 1 THEN VELOC2 = VELOC2 - VELOC / 300: LOCATE 4, 5: PRINT INT(VELOC2)
IF EJECTAR <> 1 THEN PUT (CARX, CARY), CAR1%, PSET ELSE PUT (CARX, CARY), CAR2%, PSET
CARX = CARX + VELOC / 120: CARY = CARY + .1
IF CARX >= 260 THEN GOTO ATERRAR ELSE IF CARY >= BATE AND CARX < BATE2 THEN GOTO CHOQUE
IF CARY >= 169 THEN GOTO ATERRAFINAL
IF INKEY$ = EJE$ AND TECEJE <> 1 THEN SOBE = 0: EJECTAR = 1: TECEJE = 1: X = CARX + 35: Y = CARY
IF EJECTAR = 1 THEN GOSUB EJECTAME
FOR z = 1 TO pausa: NEXT
GOTO CICLOSALTO

EJECTAME:
IF Y > 90 AND SOBE = 0 THEN Y = Y - 1: PUT (X, Y), CADEIRA%, PSET ELSE SOBE = 1
IF SOBE = 1 THEN Y = Y + .2: PUT (X, Y), PARAQ%, PSET
RETURN

CHOQUE:
LOCATE 4, 6: PRINT " 0"
DINHEIRO = DINHEIRO - 600000: HORAS = HORAS + 1: TURBO = 0: MORAL = MORAL - INT(RND * 30): CARROS = CARROS - 1
IF MORAL < 0 THEN MORAL = 0
LOCATE 4, 10: PRINT "Km/h": LOCATE 2, 4: PRINT "Vento -"; VENTO$
LOCATE 2, 19: PRINT "Dia -"; DIA: LOCATE 4, 17: PRINT "Moral -"; STR$(MORAL) + "% "
LOCATE 4, 30: PRINT "Carros -"; STR$(CARROS)
LOCATE 2, 38 - LEN(STR$(DINHEIRO)): PRINT STR$(DINHEIRO) + "$"
FOR a = 1 TO 20
PUT (CARX + 6, CARY - 5), EXPLODE2%, PSET
FOR B = 1 TO 70: NEXT B
PUT (CARX + 5, CARY - 4), EXPLODE1%, PSET
FOR B = 1 TO 70: NEXT B
IF Y > 90 AND SOBE = 0 THEN Y = Y - 2: PUT (X, Y), CADEIRA%, PSET ELSE SOBE = 1
IF SOBE = 1 AND EJECTAR = 1 THEN Y = Y + 1: PUT (X, Y), PARAQ%, PSET
NEXT a
C = 0
SIRENES:
FOR F = 400 TO 1000: SOUND F, .1: NEXT F
FOR F = 1000 TO 400 STEP -1: SOUND F, .1: NEXT F
C = C + 1: IF C = 2 THEN C = 0: GOTO CICLO
GOTO SIRENES
CICLO:
FOR F = 400 TO 800 STEP 13: SOUND F, .1: NEXT F
FOR F = 800 TO 400 STEP -13: SOUND F, .1: NEXT F
C = C + 1: IF C = 15 GOTO FIM
GOTO CICLO
FIM:
IF EJECTAR = 0 THEN LOCATE 9, 13: PRINT "MORTE INSTANTANEA": GOTO RECORDES2
IF CARROS = 0 THEN LOCATE 9, 5: PRINT "ACABARAM-SE OS CARROS DE RESERVA": GOTO RECORDES2
IF MORAL = 0 THEN LOCATE 8, 12: PRINT "MORAL IGUAL A ZERO": LOCATE 9, 6: PRINT "NAO TEM CORAGEM PARA CONTINUAR": FOR a = 1 TO 3000: NEXT a: GOTO RECORDES2
IF HORAS = HORAS2 AND COMP < COMPMAX THEN LOCATE 17, 5: PRINT "   TERMINOU A SESSAO DE SALTOS.": LOCATE 18, 5: PRINT "NAO CONSEGUIU ATINGIR O OBJECTIVO.": GOTO RECORDES2
O1$ = "X": O2$ = "": O3$ = "X": O4$ = "": O5$ = "": O6$ = "X": O7$ = "": O8$ = "X"
FOR a = 1 TO 3000: NEXT a
T$ = INKEY$
WHILE T$ <> CHR$(13)
T$ = INKEY$
WEND
GOTO CONTJOGAR2

'***************** ECRAN 3 **************************************************
ATERRAR:
CLS
LINE (0, 1)-(320, 37), 2, BF
LINE (4, 7)-(315, 31), 0, BF
LOCATE 4, 10: PRINT "Km/h": LOCATE 2, 4: PRINT "Vento -"; VENTO$
LOCATE 2, 19: PRINT "Dia -"; DIA: LOCATE 4, 17: PRINT "Moral -"; STR$(MORAL) + "%"
LOCATE 4, 30: PRINT "Carros -"; STR$(CARROS)
LOCATE 2, 38 - LEN(STR$(DINHEIRO)): PRINT STR$(DINHEIRO) + "$"
LINE (0, 40)-(320, 184), 1, BF
PUT (40, 55), ALDEIA%, PSET: PUT (150, 55), ALDEIA%, PSET
FOR a = 100 TO 108 STEP 4
PRESET (0, a): DRAW "R320"
NEXT a
FOR a = 4 TO 320 STEP 8
PRESET (a, 100): DRAW "D8"
NEXT a
PSET (0, 184): DRAW "R320": PAINT (0, 185), CO1$: LINE (0, 184)-(320, 184), 1
CARX = CARX - 260
CICLOSALTO2:
VELOC2 = VELOC2 - VELOC / 300: LOCATE 4, 5: PRINT INT(VELOC2)
IF EJECTAR <> 1 THEN PUT (CARX, CARY), CAR1%, PSET ELSE PUT (CARX, CARY), CAR2%, PSET
CARX = CARX + VELOC / 100: CARY = CARY + .2
IF CARY >= 169 THEN GOTO ATERRAFINAL
FOR z = 1 TO pausa: : NEXT
GOTO CICLOSALTO2

ATERRAFINAL:
TOTMET = CARX + VELOC2
FOR a = CARX TO TOTMET - 1
IF EJECTAR <> 1 THEN PUT (a, CARY), CAR1%, PSET ELSE PUT (a, CARY), CAR2%, PSET
SOUND 75, .06
VELOC2 = VELOC2 - .5: LOCATE 4, 5: PRINT INT(VELOC2)
NEXT a
LOCATE 4, 5: PRINT "  0"
LOCATE 17, 16: PRINT " PARABENS! "
HORAS = HORAS + 1: TURBO = 0: COMP = COMP + 1: DINHEIRO = DINHEIRO + 200000: MORAL = MORAL + INT(RND * 30)
IF MORAL > 100 THEN MORAL = 100
LOCATE 4, 10: PRINT "Km/h": LOCATE 2, 4: PRINT "Vento -"; VENTO$
LOCATE 2, 19: PRINT "Dia -"; DIA: LOCATE 4, 17: PRINT "Moral -"; STR$(MORAL) + "%"
LOCATE 4, 30: PRINT "Carros -"; STR$(CARROS)
LOCATE 2, 38 - LEN(STR$(DINHEIRO)): PRINT STR$(DINHEIRO) + "$"
LOCATE 17, 16: PRINT " PARABENS! "
IF O5$ = "X" AND O8$ = "X" THEN LOCATE 18, 14: PRINT "(TURBO PARTIDO)": O5$ = "": O6$ = "X"
IF HORAS = HORAS2 AND COMP < COMPMAX THEN LOCATE 17, 5: PRINT "   TERMINOU A SESSAO DE SALTOS.": LOCATE 18, 5: PRINT "NAO CONSEGUIU ATINGIR O OBJECTIVO.": GOTO RECORDES2
IF HORAS = HORAS2 AND COMP = COMPMAX THEN LOCATE 18, 6: PRINT "CONSEGUIU ATINGIR O OBJECTIVO.": GOSUB ESCALTURA: FOR a = 1 TO 3000: NEXT a: GOTO CONTJOGAR1
FOR a = 1 TO 3000: NEXT a
T$ = INKEY$
WHILE T$ <> CHR$(13)
T$ = INKEY$
WEND
GOTO CONTJOGAR2

ESCALTURA:
IF TEMPO = 0 THEN TEMPO = 1: RETURN
IF TEMPO = 1 THEN TEMPO = 0: DIA = DIA + 1: DINHEIRO = DINHEIRO + 400000
IF DIA = 4 THEN LOCATE 18, 6: PRINT "A SUA PROVA TERMINOU": GOTO RECORDES2
RETURN

'***************** DEFINI€AO DOS CARROS A SALTAR ****************************
CARRO3:
BATE = 153
IF COMP = 1 THEN BATE2 = 130 ELSE IF COMP = 2 THEN BATE2 = 180 ELSE IF COMP = 3 THEN BATE2 = 230 ELSE IF COMP = 4 THEN BATE2 = 280
FOR a = 1 TO COMP
PUT (CX, 169), CAR3%, PSET
CX = CX + 50
NEXT a
RETURN

CARRO4:
BATE = 155
IF COMP = 1 THEN BATE2 = 119 ELSE IF COMP = 2 THEN BATE2 = 157 ELSE IF COMP = 3 THEN BATE2 = 196 ELSE IF COMP = 4 THEN BATE2 = 234 ELSE IF COMP = 5 THEN BATE2 = 273
FOR a = 1 TO COMP
PUT (CX, 169), CAR4%, PSET
CX = CX + 39
NEXT a
RETURN

CARRO5:
BATE = 153
IF COMP = 1 THEN BATE2 = 114 ELSE IF COMP = 2 THEN BATE2 = 148 ELSE IF COMP = 3 THEN BATE2 = 182 ELSE IF COMP = 4 THEN BATE2 = 216 ELSE IF COMP = 5 THEN BATE2 = 250 ELSE IF COMP = 6 THEN BATE2 = 284
FOR a = 1 TO COMP
PUT (CX, 169), CAR5%, PSET
CX = CX + 34
NEXT a
RETURN

'***************** OP€AO REDIFINIR ******************************************
REDIFINIR:
CLS
LINE (0, 1)-(320, 37), 2, BF
LINE (4, 7)-(315, 31), 0, BF
LOCATE 12, 15: PRINT "TECLA1 - "; ESQ$: LOCATE 14, 15: PRINT "TECLA2 - "; DIR$: LOCATE 16, 15: PRINT "EJECTAR- "; EJE$
LOCATE 22, 12: PRINT "ESCOLHA AS TECLAS"
PUT (99, 12), MENU1%
CICLO2:
z$ = INKEY$
IF z$ = "" THEN GOTO CICLO2
LOCATE 12, 24: PRINT z$: ESQ$ = z$
CICLO3:
z$ = INKEY$
IF z$ = "" THEN GOTO CICLO3
LOCATE 14, 24: PRINT z$: DIR$ = z$
CICLO4:
z$ = INKEY$
IF z$ = "" THEN GOTO CICLO4
LOCATE 16, 24: PRINT z$: EJE$ = z$
LOCATE 22, 12: PRINT "                 "
FOR a = 1 TO 1500: NEXT a: CLS
RETURN

'***************** OP€AO INSTRU€OES *****************************************
INSTRUCOES:
CLS
LINE (0, 1)-(320, 37), 2, BF
LINE (4, 7)-(315, 31), 0, BF
PUT (74, 12), MENU2%
LOCATE 7, 1: PRINT "Este jogo e dividido em tres dias."
LOCATE 8, 1: PRINT "Cada  dia  de  saltos  esta dividido  nas"
LOCATE 9, 1: PRINT "partes de manha e tarde."
LOCATE 11, 1: PRINT "No 1o.dia tem de saltar ate 6 carrinhas,"
LOCATE 12, 1: PRINT "tanto de manha como a tarde."
LOCATE 13, 1: PRINT "No 2o. e  demais a prova matinal e igual"
LOCATE 14, 1: PRINT "a vespertina."
LOCATE 16, 1: PRINT "No 2o. dia tem  de saltar ate 5 carros e"
LOCATE 17, 1: PRINT "no 3o. dia tem  de saltar ate 4 camioes."
LOCATE 19, 1: PRINT "O procedimento do 1o. dia e o mesmo para"
LOCATE 20, 1: PRINT "o 2o. e 3o. dias."
LOCATE 23, 25: PRINT "Pagina 1 (de 3)"
CICLOINSTR1:
T$ = INKEY$: IF T$ = "" THEN GOTO CICLOINSTR1
CLS
LINE (0, 1)-(320, 37), 2, BF
LINE (4, 7)-(315, 31), 0, BF
PUT (74, 12), MENU2%
LOCATE 7, 1: PRINT "Antes  de saltar  sao lhe  fornecidas as"
LOCATE 8, 1: PRINT "condicoes climaticas com que vai deparar"
LOCATE 9, 1: PRINT ",tendo por  isso que  adaptar o  carro a"
LOCATE 11, 1: PRINT "cada  situacao. Assim em todos os saltos"
LOCATE 12, 1: PRINT "pode  fazer alteracoes ao  carro, utili-"
LOCATE 13, 1: PRINT "zando para  isso o  dinheiro que possui."
LOCATE 15, 1: PRINT "O  andamento  do carro  e dado  primindo"
LOCATE 16, 1: PRINT "sucessivamente  as teclas  de  andamento"
LOCATE 17, 1: PRINT "uma de cada vez."
LOCATE 19, 1: PRINT "Durante o salto  pode  carregar na tecla"
LOCATE 20, 1: PRINT "de ejectar se vir que nao consegue dar o"
LOCATE 21, 1: PRINT "salto."
LOCATE 23, 25: PRINT "Pagina 2 (de 3)"
CICLOINSTR2:
T$ = INKEY$: IF T$ = "" THEN GOTO CICLOINSTR2
CLS
LINE (0, 1)-(320, 37), 2, BF
LINE (4, 7)-(315, 31), 0, BF
PUT (74, 12), MENU2%
LOCATE 7, 1: PRINT "Cada salto equivale a uma hora. Se nao"
LOCATE 8, 1: PRINT "atingir o  objectivo durante o horario"
LOCATE 9, 1: PRINT "da sessao de saltos, o jogo termina. "
LOCATE 11, 1: PRINT "Tente somar a maior quantidade de $$$$"
LOCATE 12, 1: PRINT "para entrar  na tabela dos  recordes e"
LOCATE 13, 1: PRINT "ser assim o grande campeao do jogo :"
LOCATE 15, 1: PRINT "              VOOS LOUCOS"
LOCATE 16, 1: PRINT "              Boa sorte !"
LOCATE 18, 1: PRINT "     VOOS LOUCOS foi concebido por:"
LOCATE 19, 1: PRINT "    PAULO ALEXANDRE FERREIRA MOREIRA"
LOCATE 20, 1: PRINT "               (C)PamSoft           "
LOCATE 21, 1: PRINT "     Rio Tinto   Telef.(02)9898076"
LOCATE 23, 25: PRINT "Pagina 3 (de 3)"
CICLOINSTR3:
T$ = INKEY$: IF T$ = "" THEN GOTO CICLOINSTR3
RETURN

'***************** OP€AO RECORDES *******************************************
RECORDES:
CLS
LINE (0, 1)-(320, 37), 2, BF
LINE (4, 7)-(315, 31), 0, BF
PUT (74, 12), MENU3%
CICLOINSTR4:
T$ = INKEY$: IF T$ <> "" THEN RETURN
FOR a = 12 TO 16: LOCATE a, 10: PRINT RECOR$(a - 11): NEXT a
FOR a = 9 TO 31: FOR B = 1 TO 5: NEXT B: LOCATE 11, a: PRINT CHR$(3): LOCATE 11, a - 1: PRINT " ": NEXT a
FOR a = 31 TO 9 STEP -1: FOR B = 1 TO 5: NEXT B: LOCATE 17, a: PRINT CHR$(3): LOCATE 17, a + 1: PRINT " ": NEXT a
FOR a = 11 TO 17: FOR B = 1 TO 5: NEXT B: LOCATE a, 31: PRINT CHR$(3): LOCATE a - 1, 31: PRINT " ": NEXT a
FOR a = 17 TO 11 STEP -1: FOR B = 1 TO 5: NEXT B: LOCATE a, 9: PRINT CHR$(3): LOCATE a + 1, 9: PRINT " ": NEXT a
FOR a = 31 TO 9 STEP -1: FOR B = 1 TO 5: NEXT B: LOCATE 17, a: PRINT CHR$(3): LOCATE 17, a + 1: PRINT " ": NEXT a
FOR a = 9 TO 31: FOR B = 1 TO 5: NEXT B: LOCATE 11, a: PRINT CHR$(3): LOCATE 11, a - 1: PRINT " ": NEXT a
FOR a = 17 TO 11 STEP -1: FOR B = 1 TO 5: NEXT B: LOCATE a, 9: PRINT CHR$(3): LOCATE a + 1, 9: PRINT " ": NEXT a
FOR a = 11 TO 17: FOR B = 1 TO 5: NEXT B: LOCATE a, 31: PRINT CHR$(3): LOCATE a - 1, 31: PRINT " ": NEXT a
GOTO CICLOINSTR4

RECORDES2:
FOR a = 1 TO 3000: NEXT a
IF DINHEIRO < 1000000 THEN GOTO VOOSLOUCOS
CLS
LINE (0, 1)-(320, 37), 2, BF
LINE (4, 7)-(315, 31), 0, BF
PUT (74, 12), MENU3%
LOCATE 12, 13: PRINT "NOME:[          ]"
NOME:
T$ = INKEY$: IF T$ = "" THEN GOTO NOME
IF T$ = CHR$(13) THEN FOR a = 1 TO 2000: NEXT a: GOTO CONTNOME
IF T$ = CHR$(8) AND LEN(NOME$) > 0 THEN NOME$ = LEFT$(NOME$, LEN(NOME$) - 1): LOCATE 12, 13: PRINT "NOME:["; NOME$ + "  "
IF T$ <> CHR$(8) THEN NOME$ = NOME$ + T$: LOCATE 12, 13: PRINT "NOME:["; NOME$
IF LEN(NOME$) = 10 THEN FOR a = 1 TO 2000: NEXT a: GOTO CONTNOME
GOTO NOME
CONTNOME:
DINHEIRO$ = MID$(STR$(DINHEIRO) + "$   " + NOME$, 2, 22)
RECOR$(5) = DINHEIRO$
FOR a = 1 TO 5: FOR B = 1 TO 4
IF RECOR$(B) < RECOR$(B + 1) THEN TEMP$ = RECOR$(B + 1): RECOR$(B + 1) = RECOR$(B): RECOR$(B) = TEMP$
NEXT B, a
FOR a = 12 TO 16: LOCATE a, 10: PRINT RECOR$(a - 11): NEXT a
GOSUB ESCRITA2
CICLOINSTR5:
T$ = INKEY$: IF T$ <> "" THEN GOTO VOOSLOUCOS
FOR a = 12 TO 16: LOCATE a, 10: PRINT RECOR$(a - 11): NEXT a
FOR a = 9 TO 31: FOR B = 1 TO 5: NEXT B: LOCATE 11, a: PRINT CHR$(3): LOCATE 11, a - 1: PRINT " ": NEXT a
FOR a = 31 TO 9 STEP -1: FOR B = 1 TO 5: NEXT B: LOCATE 17, a: PRINT CHR$(3): LOCATE 17, a + 1: PRINT " ": NEXT a
FOR a = 11 TO 17: FOR B = 1 TO 5: NEXT B: LOCATE a, 31: PRINT CHR$(3): LOCATE a - 1, 31: PRINT " ": NEXT a
FOR a = 17 TO 11 STEP -1: FOR B = 1 TO 5: NEXT B: LOCATE a, 9: PRINT CHR$(3): LOCATE a + 1, 9: PRINT " ": NEXT a
FOR a = 31 TO 9 STEP -1: FOR B = 1 TO 5: NEXT B: LOCATE 17, a: PRINT CHR$(3): LOCATE 17, a + 1: PRINT " ": NEXT a
FOR a = 9 TO 31: FOR B = 1 TO 5: NEXT B: LOCATE 11, a: PRINT CHR$(3): LOCATE 11, a - 1: PRINT " ": NEXT a
FOR a = 17 TO 11 STEP -1: FOR B = 1 TO 5: NEXT B: LOCATE a, 9: PRINT CHR$(3): LOCATE a + 1, 9: PRINT " ": NEXT a
FOR a = 11 TO 17: FOR B = 1 TO 5: NEXT B: LOCATE a, 31: PRINT CHR$(3): LOCATE a - 1, 31: PRINT " ": NEXT a
GOTO CICLOINSTR5

'***************** ESCRITA DE RECORDES **************************************
ESCRITA2:
CLOSE
OPEN "REC.DAT" FOR RANDOM AS #12 LEN = 22
FIELD #12, 22 AS DADO$
FOR a = 1 TO 5
LSET DADO$ = RECOR$(a)
PUT #12, a
NEXT a
RETURN

'***************** LEITURA DOS GRAFICOS *************************************
LEITURA:
LOCATE 21, 17: PRINT "AGUARDE"
LOCATE 21, 26: PRINT "!!!!!!!!!!!!"
LOCATE 21, 26: PRINT "."
SOUND 50, 2
OPEN "C1.DAT" FOR RANDOM AS #1 LEN = 6
FIELD #1, 6 AS DADO$
FOR a = 0 TO 120
GET #1, a + 1
CAR1%(a) = VAL(DADO$)
NEXT a

LOCATE 21, 27: PRINT "."
SOUND 50, 2
OPEN "C2.DAT" FOR RANDOM AS #2 LEN = 6
FIELD #2, 6 AS DADO$
FOR a = 0 TO 120
GET #2, a + 1
CAR2%(a) = VAL(DADO$)
NEXT a

LOCATE 21, 28: PRINT "."
SOUND 50, 2
OPEN "C3.DAT" FOR RANDOM AS #3 LEN = 6
FIELD #3, 6 AS DADO$
FOR a = 0 TO 130
GET #3, a + 1
CAR3%(a) = VAL(DADO$)
NEXT a

LOCATE 21, 29: PRINT "."
SOUND 50, 2
OPEN "C4.DAT" FOR RANDOM AS #4 LEN = 6
FIELD #4, 6 AS DADO$
FOR a = 0 TO 120
GET #4, a + 1
CAR4%(a) = VAL(DADO$)
NEXT a

LOCATE 21, 30: PRINT "."
SOUND 50, 2
OPEN "C5.DAT" FOR RANDOM AS #5 LEN = 6
FIELD #5, 6 AS DADO$
FOR a = 0 TO 120
GET #5, a + 1
CAR5%(a) = VAL(DADO$)
NEXT a

LOCATE 21, 31: PRINT "."
SOUND 50, 2
OPEN "E1.DAT" FOR RANDOM AS #6 LEN = 6
FIELD #6, 6 AS DADO$
FOR a = 0 TO 150
GET #6, a + 1
EXPLODE1%(a) = VAL(DADO$)
NEXT a

LOCATE 21, 32: PRINT "."
SOUND 50, 2
OPEN "E2.DAT" FOR RANDOM AS #7 LEN = 6
FIELD #7, 6 AS DADO$
FOR a = 0 TO 150
GET #7, a + 1
EXPLODE2%(a) = VAL(DADO$)
NEXT a

LOCATE 21, 33: PRINT "."
SOUND 50, 2
OPEN "CA.DAT" FOR RANDOM AS #8 LEN = 6
FIELD #8, 6 AS DADO$
FOR a = 0 TO 40
GET #8, a + 1
CADEIRA%(a) = VAL(DADO$)
NEXT a

LOCATE 21, 34: PRINT "."
SOUND 50, 2
OPEN "PA.DAT" FOR RANDOM AS #9 LEN = 6
FIELD #9, 6 AS DADO$
FOR a = 0 TO 110
GET #9, a + 1
PARAQ%(a) = VAL(DADO$)
NEXT a

LOCATE 21, 35: PRINT "."
SOUND 50, 2
OPEN "AL.DAT" FOR RANDOM AS #10 LEN = 6
FIELD #10, 6 AS DADO$
FOR a = 0 TO 560
GET #10, a + 1
ALDEIA%(a) = VAL(DADO$)
NEXT a

LOCATE 21, 36: PRINT "."
SOUND 50, 2
OPEN "ME.DAT" FOR RANDOM AS #11 LEN = 6
FIELD #11, 6 AS DADO$
FOR a = 0 TO 8100
GET #11, a + 1
MENU%(a) = VAL(DADO$)
NEXT a

LOCATE 21, 37: PRINT "."
SOUND 50, 2
OPEN "REC.DAT" FOR RANDOM AS #12 LEN = 22
FIELD #12, 22 AS DADO$
FOR a = 1 TO 5
GET #12, a
RECOR$(a) = DADO$
NEXT a
RETURN

VELOCIDADE:
T = TIMER
FOR a = 1 TO 1000
NEXT
vel = TIMER - T
IF vel > 1.1 THEN pausa = 0 ELSE pausa = 200
RETURN


