CODIGO SEGMENT
ASSUME CS:CODIGO, DS:CODIGO, ES:CODIGO, SS:CODIGO
ORG 100H

INICIO PROC NEAR

MOV DX, OFFSET MENSAGEM
MOV AH,9H         ; ESCREVE O ECRAN DE INICIO
INT 21H           ; COM O CONTEUDO DE MENSAGEM

CALL VIRUS_ANALISE

MOV AH, 4CH
INT 21H

INICIO ENDP

;   *** DADOS ***

VYN      DB 0

NOVIRUS  DB 'N„o foram encontrados virus.',10,13,'$'

MENSAGEM DB 10,13
         DB 'IntVirus 1.0 - Virus por Interrup‡”es.'
         DB 10,13
         DB '(C) 1993 - Luciano Oliveira - Tel : (044) 612794 - Monte Real.'
         DB 10,13
         DB 10,13
         DB '  Este programa analiza as interrup‡”es usadas por alguns virus'
         DB 10,13
         DB ' para analisar se estes est„o ou n„o instalados na mem¢ria RAM.'
         DB 10,13
         DB 10,13
         DB '$'

VIRUS DB ' residente em mem¢ria !!!'
        DB 10,13
        DB 'Desligue o seu computador e execute um programa anti-virus.$'

PERFUME        DB 'Virus Perfume$'
CRAZY_IMP      DB 'Virus Crazy Imp$'
POSSESSED      DB 'Virus Possessed$'
DUTCH_555      DB 'Virus Dutch-555 / Quit 1992$'
BURGHOFER      DB 'Virus Burghofer$'
OROPAX         DB 'Virus Oropax$'
AGIPLAN        DB 'Virus Agiplan / Month 4-6$'
JD_448         DB 'Virus JD-448$'
SHAKE          DB 'Virus Shake$'
INVADER        DB 'Virus Invader$'
MG             DB 'Virus MG$'
THIRTEEN       DB 'Virus 699 / Thirteen Minutes$'
MONO           DB 'Virus 1063 / Mono$'
PLASTIQUE      DB 'Virus Plastique / AntiCad$'
JABBERWOCKY    DB 'Virus Jabberwocky$'
HORSE_2        DB 'Virus Horse-2$'
PATRICIA       DB 'Virus Murphy-2 ou Patricia / Smack$'
PLASTIQUE_2576 DB 'Virus Plastique-2576 / AntiCad-2576$'
HORSE          DB 'Virus Horse$'
SPARSE         DB 'Virus Sparse$'
MURPHY_1       DB 'Virus Murphy-1 ou Murphy-4$'
BROTHERS       DB 'Virus Brothers$'
SHIRLEY        DB 'Virus Shirley$'
ZHERKOV_1882   DB 'Virus Zherkov-1882$'
DASH_EM        DB 'Virus 1876 / Dash-em$'
NOMENKLATURA   DB 'Virus Nomenklatura$'
SCREENPLUS1    DB 'Virus 948 / Screenplus1$'
MAGNITOGORSK   DB 'Virus Magnitogorsk$'
LOZINSKY       DB 'Virus Lozinsky$'
HITCHCOCK      DB 'Virus Hitchcock$'
DARKAVENGER    DB 'Virus Dark Avenger-1028$'
COPYRIGHT      DB 'Virus 1193 / Copyright$'
USSR_707       DB 'Virus USSR-707$'
JUSTICE        DB 'Virus Justice$'
EUROPE92       DB 'Virus Europe 92$'
CASCADE        DB 'Virus Cascade$'
LEAPFROG       DB 'Virus 516 / Leapfrog$'
HEADCRASH      DB 'Virus 1067 / Headcrash$'
RAPE_747       DB 'Virus Rape-747$'
KLAEREN        DB 'Virus Klaeren / Hate$'
GROWINGBLOCK   DB 'Virus Growing Block$'
SQUEAKER       DB 'Virus Squeaker$'
SVC            DB 'Virus SVC$'
SVC5           DB 'Virus SVC 5.0 ou SVC 6.0$'
VRIEST         DB 'Virus Vriest$'
CARIOCA        DB 'Virus Carioca$'
FILEHIDER      DB 'Virus 789 / Filehider$'
EDDIE_2        DB 'Virus Eddie-2$'
BLINKER        DB 'Virus Blinker$'
BACKTIME       DB 'Virus Backtime$'
VORONEZH       DB 'Virus 600 ou da familia Voronezh$'
HEYYOU         DB 'Virus Hey You$'
DATALOCK       DB 'Virus Datalock$'
USSR_1049      DB 'Virus USSR-1049$'
SLOW           DB 'Virus Slow / Zerotime$'
SOLANO         DB 'Virus Solano$'
BACKFONT       DB 'Virus 905 / Backfont$'
SVERDLOV       DB 'Virus Sverdlov$'
SOCHA          DB 'Virus Socha$'
YANKEE         DB 'Virus Yankee ou MLTI$'
MH_757         DB 'Virus MH-757$'
MILOUS         DB 'Virus Milous$'
WITCODE        DB 'Virus Witcode$'
WESTWOOD       DB 'Virus Westwood$'
FELLOWSHIP     DB 'Virus Fellowship$'
DIAMOND_A      DB 'Virus Diamond-A$'
DIAMOND_B      DB 'Virus da familia Diamond-B$'
DIR            DB 'Virus Dir$'
GOTCHA         DB 'Virus Gotcha$'
PLOVDIV        DB 'Virus Plovdiv 1.3$'
DURBAN         DB 'Virus Durban$'
JERUSALEM      DB 'Virus Jerusalem$'
ARMAGEDON      DB 'Virus Armagedon$'
_8_TUNES       DB 'Virus 8-Tunes$'
MENDOZA        DB 'Virus Mendoza$'
FUMANCHU       DB 'Virus Fu Manchu$'
ANARKIA        DB 'Virus Anarkia$'
SPYER          DB 'Virus Spyer / Kiev$'
TERROR         DB 'Virus Terror$'
JERUSALEM_G    DB 'Virus Jerusalem-G$'
PREGNANT       DB 'Virus Pregnant$'
FREREJACQUES   DB 'Virus Frere Jacques$'
PCVRSDS        DB 'Virus PcVrsDs$'
CARFIELD       DB 'Virus Carfield$'
GP1            DB 'Virus GP1$'
CINDERELLA     DB 'Virus Cinderella$'
DBASE          DB 'Virus dBASE$'
TROI           DB 'Virus Troi$'
BORDER         DB 'Virus Border$'
_483           DB 'Virus 483$'
FLIP           DB 'Virus Flip$'
TEQUILA        DB 'Virus 2468 / Tequila$'
BLACKMONDAY    DB 'Virus Black Monday$'
TUMEN          DB 'Virus Tumen 0.5 ou Hero$'
SUNDAY         DB 'Virus Sunday$'
TWINS          DB 'Virus Twins$'
MANYFINGERS    DB 'Virus 80/15 / Many Fingers$'
ONTARIO        DB 'Virus Ontario$'
REVENGE        DB 'Virus Revenge$'



VIRUS_ANALISE PROC NEAR

MOV BYTE VYN ,00H
                                ; VIRUS PERFUME
MOV AX, 0B56H                   ; GUARDA O VALOR X EM AX
INT 21H                         ; CHAMA O INTERRUPT DAS FUN€™ES DO DOS
CMP AX,4952H                    ; COMPARA O VALOR DE AX COM X
IF Z MOV DX, OFFSET PERFUME     ; SE FOREM IGUAIS REGISTA EM DX O OFFSET DA
IF Z CALL VIRUS_INST            ; MENSAGEM E CHAMA O LABEL VIRUS_INST

MOV AX, 0D20H      ; VIRUS CRAZY IMP
INT 21H
CMP AX, 1971H
IF Z MOV DX, OFFSET CRAZY_IMP
IF Z CALL VIRUS_INST

MOV AH, 30H        ; VIRUS POSSESSED
MOV DX, 0ABCDH
INT 21H
CMP DX,0DCBAH
IF Z MOV DX, OFFSET POSSESSED
IF Z CALL VIRUS_INST

MOV AX, 30F1H      ; VIRUS DUTCH-555 / QUIT 1992
INT 21H
CMP AL,00H
IF Z MOV DX, OFFSET DUTCH_555
IF Z CALL VIRUS_INST

MOV AX, 330FH      ; VIRUS BURGHOFER
INT 21H
CMP AL,0FH
IF Z MOV DX, OFFSET BURGHOFER
IF Z CALL VIRUS_INST

MOV AX, 33E0H      ; VIRUS OROPAX
INT 21H    
CMP AL, 0E0H 
IF Z MOV DX, OFFSET OROPAX
IF Z CALL VIRUS_INST

MOV AX, 357FH      ; VIRUS AGIPLAN / MONTH 4-6 
INT 21H
CMP DX, 0FFFFH
IF Z MOV DX, OFFSET AGIPLAN
IF Z CALL VIRUS_INST

MOV AX, 3DFFH      ; VIRUS JD-448
INT 21H
CMP AX, 4A44H
IF Z MOV DX, OFFSET JD_448
IF Z CALL VIRUS_INST

MOV AX, 4203H      ; VIRUS SHAKE
INT 21H
CMP AX, 1234H
IF Z MOV DX, OFFSET SHAKE
IF Z CALL VIRUS_INST

MOV AX, 4243H      ; VIRUS INVADER
INT 21H
CMP AX, 5678H
IF Z MOV DX, OFFSET INVADER
IF Z CALL VIRUS_INST

MOV AX, 4B04H      ; VIRUS 699 / THIRTEEN MINUTES E VIRUS MG
INT 21H
IF NC MOV DX, OFFSET MG
IF NC CALL VIRUS_INST
CMP AX, 044BH
IF Z MOV DX, OFFSET THIRTEEN
IF Z CALL VIRUS_INST

MOV AX, 4B25H      ; VIRUS MONO / 1063
INT 21H
CMP DI, 1234H
IF Z MOV DX, OFFSET MONO
IF Z CALL VIRUS_INST

MOV AX, 4B40H      ; VIRUS PLASTIQUE / ANTICAD
INT 21H
CMP AX, 5678H
IF Z MOV DX, OFFSET PLASTIQUE
IF Z CALL VIRUS_INST

MOV AX, 4B4AH      ; VIRUS JABBERWOCKY
INT 21H
CMP AL, 57H
IF Z MOV DX, OFFSET JABBERWOCKY
IF Z CALL VIRUS_INST

MOV AX, 4B4BH      ; VIRUS HORSE-2
INT 21H
IF NC MOV DX, OFFSET HORSE_2
IF NC CALL VIRUS_INST

MOV AX, 4B4DH      ; VIRUS MURPKY-2 OU PATRICIA/SMACK
INT 21H
IF NC MOV DX, OFFSET PATRICIA
IF NC CALL VIRUS_INST

MOV AX, 4B50H      ; VIRUS PLASTIQUE-2576 / ANTICAD-2576
INT 21H
CMP AX, 1234H
IF Z MOV DX, OFFSET PLASTIQUE_2576
IF Z CALL VIRUS_INST

MOV AX, 4B53H      ; VIRUS HORSE
INT 21H
IF NC MOV DX, OFFSET HORSE
IF NC CALL VIRUS_INST

MOV AX, 4B55H     ; VIRUS SPARSE
INT 21H
CMP AX, 1231H
IF Z MOV DX, OFFSET SPARSE
IF Z CALL VIRUS_INST

MOV AX, 4B59H     ; VIRUS MURPHY-1 OU MURPHY-4
INT 21H
IF NC MOV DX, OFFSET MURPHY_1
IF NC CALL VIRUS_INST

MOV AX, 4B5EH     ; VIRUS BROTHERS
INT 21H
IF NC MOV DX, OFFSET BROTHERS
IF NC CALL VIRUS_INST

MOV AX, 4B87H     ; VIRUS SHIRLEY
INT 21H
CMP AX, 6663H
IF Z MOV DX, OFFSET SHIRLEY
IF Z CALL VIRUS_INST

MOV AX, 4B95H     ; VIRUS ZHERKOV-1882
INT 21H
CMP AX, 1973H
IF Z MOV DX, OFFSET ZHERKOV_1882
IF Z CALL VIRUS_INST

MOV AX, 4BA7H     ; VIRUS 1876/DASH-EM
INT 21H
CMP AX, 0B459H
IF Z MOV DX, OFFSET DASH_EM
IF Z CALL VIRUS_INST

MOV AX, 4BAAH     ; VIRUS NOMENKLATURA
INT 21H
IF NC MOV DX, OFFSET NOMENKLATURA
IF NC CALL VIRUS_INST

MOV AX, 4BAFH     ; VIRUS 948/SCREENPLUS1 E MAGNITOGORSK
INT 21H
CMP AL, 0AFH
IF Z MOV DX, OFFSET MAGNITOGORSK
IF Z CALL VIRUS_INST
CMP AL, 0FAH
IF Z MOV DX, OFFSET SCREENPLUS1
IF Z CALL VIRUS_INST

MOV AX, 4BDDH     ; VIRUS LOZINSKY/ZHERKOV
INT 21H
CMP AX, 1234H
IF Z MOV DX, OFFSET LOZINSKY
IF Z CALL VIRUS_INST

MOV AX, 4BFEH     ; VIRUS HITCHCOCK E DARK AVENGER-1028 E 1193
INT 21H
CMP AX, 1234H
IF Z MOV DX, OFFSET HITCHCOCK
IF Z CALL VIRUS_INST
CMP AX, 0ABCDH
IF Z MOV DX, OFFSET COPYRIGHT
IF Z CALL VIRUS_INST
CMP AX, 55BBH
IF Z MOV DX, OFFSET DARKAVENGER
IF Z CALL VIRUS_INST

MOV AX, 4BFFH     ; VIRUS USSR-707 E JUSTICE E EUROPE 92
INT 21H
IF NC MOV DX, OFFSET EUROPE92
IF NC CALL VIRUS_INST
CMP BL, 0FFH
IF Z MOV DX, OFFSET USSR_707
IF Z CALL VIRUS_INST
CMP DI, 55AAH
IF Z MOV DX, OFFSET JUSTICE
IF Z CALL VIRUS_INST

MOV AX, 4BFFH     ; VIRUS CASCADE
MOV SI, 0000H
MOV DI, 0000H
INT 21H
CMP DI, 55AAH
IF Z MOV DX, OFFSET CASCADE
IF Z CALL VIRUS_INST

MOV AX, 5252H     ; VIRUS 516/LEAPFROG
INT 21H
CMP BX, 0FFEEH
IF Z MOV DX, OFFSET LEAPFROG
IF Z CALL VIRUS_INST

MOV AX, 58CCH     ; VIRUS 1067/HEADCRASH
INT 21H
IF NC MOV DX, OFFSET HEADCRASH
IF NC CALL VIRUS_INST

MOV AX, 6969H     ; VIRUS RAPE-747
INT 21H
CMP AX, 0666H
IF Z MOV DX, OFFSET RAPE_747
IF Z CALL VIRUS_INST

MOV AH, 79H       ; VIRUS KLAEREN/HATE
INT 21H
CMP AL, 48H
IF Z MOV DX, OFFSET KLAEREN
IF Z CALL VIRUS_INST

MOV AX, 7700H     ; VIRUS GROWING BLOCK
INT 21H
CMP AX, 0920H
IF Z MOV DX, OFFSET GROWINGBLOCK
IF Z CALL VIRUS_INST

MOV AH, 7FH       ; VIRUS SQUEAKER
INT 21H
CMP AH, 80H
IF Z MOV DX, OFFSET SQUEAKER
IF Z CALL VIRUS_INST

MOV AH, 83H       ; VIRUS SVC
INT 21H
CMP DX, 1990H
IF Z MOV DX, OFFSET SVC
IF Z CALL VIRUS_INST

MOV AH, 84H       ; VIRUS SVC 5.0 OU SVC 6.0
INT 21H
CMP DX, 1990H
IF Z MOV DX, OFFSET SVC5
IF Z CALL VIRUS_INST

MOV AH, 89H       ; VIRUS VRIEST
INT 21H
CMP AX, 0123H
IF Z MOV DX, OFFSET VRIEST
IF Z CALL VIRUS_INST

MOV AH, 90H       ; VIRUS CARIOCA
INT 21H
CMP AH, 01H
IF Z MOV DX, OFFSET CARIOCA
IF Z CALL VIRUS_INST

MOV AX, 0A1D5H    ; VIRUS 789 / FILEHIDER
INT 21H
CMP AX, 900DH
IF Z MOV DX, OFFSET FILEHIDER
IF Z CALL VIRUS_INST

MOV AX, 0A55AH    ; VIRUS EDDIE-2
INT 21H
CMP AX, 5AA5H
IF Z MOV DX, OFFSET EDDIE_2
IF Z CALL VIRUS_INST

MOV AX, 0AA00H    ; VIRUS BLINKER
INT 21H
CMP AX, 00AAH
IF Z MOV DX, OFFSET BLINKER
IF Z CALL VIRUS_INST

MOV AX, 0AA03H    ; VIRUS BACKTIME
INT 21H
CMP AX, 03AAH
IF Z MOV DX, OFFSET BACKTIME
IF Z CALL VIRUS_INST

MOV AH, 0ABH      ; VIRUS 600/VORONEZH FAMILY
INT 21H
CMP AX, 5555H
IF Z MOV DX, OFFSET VORONEZH
IF Z CALL VIRUS_INST

MOV AX, 0BBBBH    ; VIRUS HEY YOU
INT 21H
CMP AX, 6969H
IF Z MOV DX, OFFSET HEYYOU
IF Z CALL VIRUS_INST

MOV AH, 0BEH      ; VIRUS DATALOCK
INT 21H
CMP AX, 1234H
IF Z MOV DX, OFFSET DATALOCK
IF Z CALL VIRUS_INST

MOV AX, 0BE00H    ; VIRUS USSR-1049
MOV DX, 5555H
ADD DX, 0FFFFH
INT 21H
IF NC MOV DX, OFFSET USSR_1049
IF NC CALL VIRUS_INST

MOV AX, 0C301H    ; VIRUS 905/BACKFONT
MOV DX, 0F1F1H
INT 21H
CMP DX, 0E0EH
IF Z MOV DX, OFFSET BACKFONT
IF Z CALL VIRUS_INST

MOV AX, 0C500H    ; VIRUS SVERDLOV
INT 21H
CMP AX, 6731H
IF Z MOV DX, OFFSET SVERDLOV
IF Z CALL VIRUS_INST

MOV AH, 0C6H      ; VIRUS SOCHA
INT 21H
CMP AL, 55H
IF Z MOV DX, OFFSET SOCHA
IF Z CALL VIRUS_INST

MOV AX, 0C603H    ; VIRUS YANKEE OU MLTI
MOV DX, 5555H
ADD DX, 0FFFFH
INT 21H
IF NC MOV DX, OFFSET YANKEE
IF NC CALL VIRUS_INST

MOV AX, 0C700H    ; VIRUS MH-757
INT 21H
CMP AL, 07H
IF Z MOV DX, OFFSET MH_757
IF Z CALL VIRUS_INST

MOV AH, 0CBH      ; VIRUS MILOUS
INT 21H
CMP AL, 07H
IF Z MOV DX, OFFSET MILOUS
IF Z CALL VIRUS_INST

MOV AX, 0CB02H    ; VIRUS WITCODE
INT 21H
CMP AX, 02CBH
IF Z MOV DX, OFFSET WITCODE
IF Z CALL VIRUS_INST

MOV AH, 0CCH      ; VIRUS WESTWOOD
INT 21H
CMP AX, 0700H
IF Z MOV DX, OFFSET WESTWOOD
IF Z CALL VIRUS_INST

MOV AX, 0D000H    ; VIRUS FELLOWSHIP
INT 21H
CMP BX, 1234H
IF Z MOV DX, OFFSET FELLOWSHIP
IF Z CALL VIRUS_INST

MOV AX, 0D5AAH      ; VIRUS DIAMOND-A E DIAMOND-B
INT 21H
CMP AX, 02A55H
IF Z MOV DX, OFFSET DIAMOND_A
IF Z CALL VIRUS_INST
CMP AX, 02A03H
IF Z MOV DX, OFFSET DIAMOND_B
IF Z CALL VIRUS_INST

MOV AX, 0D5AAH    ; VIRUS DIR
MOV BP, 0DEAAH
INT 21H
CMP SI, 4321H
IF Z MOV DX, OFFSET DIR
IF Z CALL VIRUS_INST

MOV AX, 0DADAH    ; VIRUS GOTCHA
INT 21H
CMP AH, 0A5H
IF Z MOV DX, OFFSET GOTCHA
IF Z CALL VIRUS_INST

MOV AX, 0DAFEH    ; VIRUS PLOVDIV 1.3
INT 21H
CMP AX, 1234H
IF Z MOV DX, OFFSET PLOVDIV
IF Z CALL VIRUS_INST

MOV AH, 0DEH      ; VIRUS DURBAN
INT 21H
CMP AH, 0DFH
IF Z MOV DX, OFFSET DURBAN
IF Z CALL VIRUS_INST

MOV AX, 0DEDEH    ; VIRUS BROTHERS
INT 21H
CMP AH, 41H
IF Z MOV DX, OFFSET BROTHERS
IF Z CALL VIRUS_INST

MOV AH, 0E0H      ; VIRUS JERUSALEM E ARMAGEDON
INT 21H
CMP AX, 0300H
IF Z MOV DX, OFFSET JERUSALEM
IF Z CALL VIRUS_INST
CMP AX, 0DADAH
IF Z MOV DX, OFFSET ARMAGEDON
IF Z CALL VIRUS_INST

MOV AX, 0E00FH    ; VIRUS 8-TUNES
INT 21H
CMP AX, 4C31H
IF Z MOV DX, OFFSET _8_TUNES
IF Z CALL VIRUS_INST

MOV AH, 0E1H      ; VIRUS MENDOZA E FU MANCHU
INT 21H
CMP AX, 0300H
IF Z MOV DX, OFFSET MENDOZA
IF Z CALL VIRUS_INST
CMP AX, 0400H
IF Z MOV DX, OFFSET FUMANCHU
IF Z CALL VIRUS_INST

MOV AH, 0E4H      ; VIRUS ANARKIA
INT 21H
CMP AH, 04H
IF Z MOV DX, OFFSET ANARKIA
IF Z CALL VIRUS_INST

MOV AH, 0E7H      ; VIRUS SPYER/KIEV
INT 21H
CMP AH, 78H
IF Z MOV DX, OFFSET SPYER
IF Z CALL VIRUS_INST

MOV AX, 0EC59H    ; VIRUS TERROR
INT 21H
CMP BP, 0EC59H
IF Z MOV DX, OFFSET TERROR
IF Z CALL VIRUS_INST

MOV AH, 0EEH      ; VIRUS JERUSALEM-G E PREGNANT
INT 21H
CMP AX, 0300H
IF Z MOV DX, OFFSET JERUSALEM_G
IF Z CALL VIRUS_INST
CMP AL, 05H
IF Z MOV DX, OFFSET PREGNANT
IF Z CALL VIRUS_INST

MOV AH, 0F0H      ; VIRUS FRERE JACQUES
INT 21H
CMP AX, 0300H
IF Z MOV DX, OFFSET FREREJACQUES
IF Z CALL VIRUS_INST

MOV AX, 0F2AAH    ; VIRUS PCVRSDS
INT 21H
CMP AH, 0AAH
IF Z MOV DX, OFFSET PCVRSDS
IF Z CALL VIRUS_INST

MOV AH, 0F3H      ; VIRUS CARFIELD
INT 21H
CMP AX, 0400H
IF Z MOV DX, OFFSET CARFIELD
IF Z CALL VIRUS_INST

MOV AH, 0F7H      ; VIRUS GP1
INT 21H
CMP AX, 0300H
IF Z MOV DX, OFFSET GP1
IF Z CALL VIRUS_INST

MOV AH, 0FBH      ; VIRUS CINDERELLA
INT 21H
CMP AH, 00H
IF Z MOV DX, OFFSET CINDERELLA
IF Z CALL VIRUS_INST

MOV AX, 0FB0AH    ; VIRUS DBASE
INT 21H
CMP AX, 0AFBH
IF Z MOV DX, OFFSET DBASE
IF Z CALL VIRUS_INST

MOV AH, 0FCH      ; VIRUS TROI
INT 21H
CMP AL, 0A5H
IF Z MOV DX, OFFSET TROI
IF Z CALL VIRUS_INST

MOV AH, 0FDH      ; VIRUS BORDER
INT 21H
CMP AH, 13H
IF Z MOV DX, OFFSET BORDER
IF Z CALL VIRUS_INST

MOV AH, 0FEH      ; VIRUS 483
INT 21H
CMP AH, 00H
IF Z MOV DX, OFFSET _483
IF Z CALL VIRUS_INST

MOV AX, 0FE01H    ; VIRUS FLIP
INT 21H
CMP AX, 01FEH
IF Z MOV DX, OFFSET FLIP
IF Z CALL VIRUS_INST

MOV AX, 0FE02H    ; VIRUS 2468/TEQUILA
INT 21H
CMP AX, 01FDH
IF Z MOV DX, OFFSET TEQUILA
IF Z CALL VIRUS_INST

MOV AX, 0FEDCH    ; VIRUS BLACK MONDAY
INT 21H
CMP AL, 0DCH
IF Z MOV DX, OFFSET BLACKMONDAY
IF Z CALL VIRUS_INST

MOV AH, 0FFH      ; VIRUS SUNDAY E TUMEN 0.5 E HERO
INT 21H
CMP AH, 00H
IF Z MOV DX, OFFSET TUMEN
IF Z CALL VIRUS_INST
CMP AX, 0400H
IF Z MOV DX, OFFSET SUNDAY
IF Z CALL VIRUS_INST

MOV AX, 0FF10H    ; VIRUS TWINS
INT 21H
CMP AL, 07H
IF Z MOV DX, OFFSET TWINS
IF Z CALL VIRUS_INST

MOV AX, 0FFFEH    ; VIRUS 08/15 / MANY FINGERS
INT 21H
CMP AX, 0815H
IF Z MOV DX, OFFSET MANYFINGERS
IF Z CALL VIRUS_INST

MOV AX, 0FFFFH    ; VIRUS ONTARIO
INT 21H
CMP AX, 0000H
IF Z MOV DX, OFFSET ONTARIO
IF Z CALL VIRUS_INST

MOV AX, 0FFFFH    ; VIRUS REVENGE
MOV CX, 0000H
INT 21H
CMP CX, 0006H
IF Z MOV DX, OFFSET REVENGE
IF Z CALL VIRUS_INST

CMP VYN,01H
JZ >L0
MOV DX, OFFSET NOVIRUS
MOV AH,09H
INT 21H

L0:
   RET

VIRUS_INST:
        MOV VYN,01H
        MOV AH,9H
        INT 21H
        MOV DX,OFFSET VIRUS
        MOV AH,9H
        INT 21H
        RET

VIRUS_ANALISE ENDP

CODIGO ENDS
END INICIO


