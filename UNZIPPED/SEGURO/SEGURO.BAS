C$ = COMMAND$
OPEN "C:\DOS\DIR.DAT" FOR INPUT AS #1
INPUT #1, DIR$
CLOSE #1
FICH1$ = DIR$ + "\NUMERO.NUM"
FICH2$ = DIR$ + "\REGISTO.DAT"

 PRINT "SEGURO v1.1"
 PRINT "Por RUI PACHECO"
 PRINT "Janeiro 1994"
 PRINT

SELECT CASE C$
 
   CASE "/INI"
 OPEN FICH2$ FOR RANDOM AS #1
 FIELD #1, 8 AS HORA$, 10 AS DATA$
 CLOSE
 OPEN FICH1$ FOR OUTPUT AS #1
 CLOSE
 KILL FICH2$
 KILL FICH1$
 N = 1
 OPEN FICH1$ FOR OUTPUT AS #1
 WRITE #1, N
 CLOSE
 PRINT TAB(5); "REGISTOS INICIALIZADOS!"
 END

   CASE "/M"
 OPEN FICH1$ FOR INPUT AS #1
 INPUT #1, NUM
 N = NUM
 CLOSE #1
 OPEN FICH2$ FOR RANDOM AS #1
 FIELD #1, 8 AS HORA$, 10 AS DATA$
 T = 0
 FOR I = 1 TO N - 1
 GET #1, I
 IF T = 0 THEN
 PRINT "N§ REGISTO        HORA         DATA"
 PRINT STRING$(38, "Ä")
 END IF
 PRINT TAB(5); I; TAB(17); HORA$; TAB(29); DATA$
 T = T + 1
 IF T = 18 THEN
    PRINT
    PRINT "PRESSIONE QUALQUER TECLA PARA CONTINUAR..."
    SLEEP
    CLS
    T = 0
 END IF
 NEXT I
 CLOSE
 END

   CASE "/I"
 ON ERROR GOTO ERRO
 OPEN FICH1$ FOR INPUT AS #1
 INPUT #1, NUM
 N = NUM
 PAG = 1
 CLOSE #1
 OPEN FICH2$ FOR RANDOM AS #1
 FIELD #1, 8 AS HORA$, 10 AS DATA$
 T = 0
 FOR I = 1 TO N - 1
 GET #1, I
 IF T = 0 THEN
 LPRINT "N§ REGISTO        HORA         DATA"
 LPRINT STRING$(38, "Ä")
 END IF
 LPRINT TAB(5); I; TAB(17); HORA$; TAB(29); DATA$
 T = T + 1
 IF T = 60 THEN
    LPRINT
    LPRINT
    LPRINT TAB(15); "PAGINA "; PAG
    FOR P = 1 TO 7
    LPRINT
    NEXT P
    PAG = PAG + 1
    T = 0
 END IF
 NEXT I
 CLOSE
 END
  
   CASE ELSE
 PRINT TAB(5); "SINTAXE:   SEGURO [/INI] [/I] [/M]"
 PRINT
 PRINT TAB(2); "/INI"; TAB(10); "Inicializa‡„o dos registos"
 PRINT TAB(2); "/I"; TAB(10); "Visualiza‡„o dos registos na impressora"
 PRINT TAB(2); "/M"; TAB(10); "Visualiza‡„o dos registos no monitor"
 END

END SELECT

ERRO:
 PRINT TAB(10); "IMPRESSORA DESLIGADA!"
 END

